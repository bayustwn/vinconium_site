# Puzzle #7 - The 2048 Killer

## Ringkasan Cerita

Para warga lokal melaporkan bau busuk dari sebuah rumah kosong. Polisi menemukan ember berisi potongan daging, ruangan penuh tulisan "2048", dan sebuah flash disk mencurigakan. Kita diminta untuk menyelidiki aplikasi di flash disk tersebut.

![2048](https://hackmd.io/_uploads/BJcGda_L-l.png)

---

## Step 1: Analisis Gambar

Dari foto flash disk, ditemukan URL yang mengarah ke APK game 2048:
- **URL**: https://pusatkode.com/2048.png

<div style={{ textAlign: 'center' }}>
  <img src="https://hackmd.io/_uploads/r1kB35orWe.jpg" alt="Game 2048" width="200" />
</div>

---

## Step 2: Reverse Engineering APK

Setelah menganalisis APK, ditemukan bahwa:
- Ketika score mencapai 100.000, aplikasi akan melakukan fetch ke URL tertentu
- Melalui deobfuscation file JavaScript, didapatkan URL tujuan:

**URL**: `https://gpousdcgce3cdx3ds6r32kwyga0igmsy.lambda-url.ap-southeast-1.on.aws/`

<div style={{ textAlign: 'center' }}>
  <img src="https://hackmd.io/_uploads/HJugAqjr-g.png" alt="Deobfuscated Code" width="400" />
</div>

---

## Step 3: Analisis Response API

Dengan melakukan multiple fetch ke URL tersebut, ditemukan 3 response berbeda berupa binary array (0 dan 1).

### Konversi ke Gambar

Binary array ini ternyata merupakan bitmap dengan spesifikasi:
- 0 = hitam
- 1 = putih  
- Resolusi = 32x64 pixel

**Script Python untuk konversi:**

```python
import os
from PIL import Image
import re

folder = "."
pattern = re.compile(r"response_(\d+)\.txt$")
width, height = 32, 64
layers = []

files = sorted([f for f in os.listdir(folder) if pattern.match(f)])[:3]
for filename in files:
    with open(os.path.join(folder, filename), "r") as f:
        content = f.read()
    bits = [int(c) for c in content if c in "01"]
    total = width * height
    if len(bits) < total:
        bits += [0] * (total - len(bits))
    elif len(bits) > total:
        bits = bits[:total]
    layers.append(bits)

final_bits = []
for i in range(width * height):
    pixel = 0
    for layer in layers:
        if layer[i] == 1:
            pixel = 1
            break
    final_bits.append(pixel)

img = Image.new("L", (width, height))
img.putdata([255 if b else 0 for b in final_bits])
img.save("output.png")
```

**Hasil:**

<div style={{ display: 'flex', justifyContent: 'center', gap: '40px', textAlign: 'center' }}>
  <div>
    <img src="https://hackmd.io/_uploads/Bkm1GooSWx.png" />
    <div>Hasil Awal</div>
  </div>
  <div>
    <img src="https://hackmd.io/_uploads/Hk-WfioB-l.png" />
    <div>Setelah Mirroring</div>
  </div>
</div>

Dari gambar tersebut didapat URL baru: **https://pusatkode.com/w4aQKwA9**

---

## Step 4: Analisis File HTML

File tersebut merupakan HTML dengan title "2:0:4:8" yang menampilkan jam dengan timezone UTC.

![Clock](https://hackmd.io/_uploads/SyJxNojBWx.png)

### Deobfuscated JavaScript

```javascript
function updateClock() {
    const now = new Date();
    const hours = String(now.getUTCHours()).padStart(2, "0");
    const minutes = String(now.getUTCMinutes()).padStart(2, "0");
    const seconds = String(now.getUTCSeconds()).padStart(2, "0");
    const timeString = `${hours}:${minutes}:${seconds}`;
    const hmString = `${hours}:${minutes}`;

    document.getElementById("clock").textContent = timeString;

    const triggerTimes = [
        "00:00", "00:02", "00:04", "00:08",
        "00:20", "00:22", "00:24", "00:28",
        // ... dst (pola 2048)
    ];

    if (triggerTimes.includes(hmString)) {
        callAPI();
    }
}

async function callAPI() {
    const response = await fetch(
        "https://oa6sjncccrkrswy57vw3744gm40ibuqo.lambda-url.ap-southeast-1.on.aws/"
    );
    const data = await response.text();
    // ... tampilkan button dengan URL
}
```

Pada waktu-waktu tertentu dengan pola "2048" (misal 00:02, 00:04, 02:00, dst), akan fetch URL baru yang divalidasi oleh server time.

**URL yang didapat**: `https://oa6sjncccrkrswy57vw3744gm40ibuqo.lambda-url.ap-southeast-1.on.aws/`

---

## Step 5: Decoding Morse Code

Hasil fetch pada waktu trigger (2026-01-17 20:00:00 UTC): **https://pusatkode.com/UWQPprdi.txt**

File ini berisi kode morse dengan encoding khusus:
- `ㅤ` (U+3164, Hangul Filler) = `.` (titik)
- ` ` (U+2800, Braille Blank) = `-` (garis)
- ` ` (spasi biasa) = pemisah huruf
- `.` (titik fisik) = pemisah kata

**Script Python untuk decode:**

```python
MORSE = {
    '.-':'A', '-...':'B', '-.-.':'C', '-..':'D', '.':'E',
    '..-.':'F', '--.':'G', '....':'H', '..':'I', '.---':'J',
    '-.-':'K', '.-..':'L', '--':'M', '-.':'N', '---':'O',
    '.--.':'P', '--.-':'Q', '.-.':'R', '...':'S', '-':'T',
    '..-':'U', '...-':'V', '.--':'W', '-..-':'X', '-.--':'Y',
    '--..':'Z', '-----':'0', '.----':'1', '..---':'2',
    '...--':'3', '....-':'4', '.....':'5', '-....':'6',
    '--...':'7', '---..':'8', '----.':'9'
}

with open('UWQPprdi.txt', encoding='utf-8') as f:
    raw = f.read()

morse = ''.join(
    '.' if c=='\u3164' else 
    '-' if c=='\u2800' else 
    ' ' if c==' ' else 
    '/' if c=='.' else '' 
    for c in raw
)

words = morse.split('/')
result = ' '.join(
    ''.join(MORSE.get(l,'?') for l in w.split() if l) 
    for w in words
)
print(result)
```

**Hasil decode:**

```
ADA BISIKAN DARI 2048 TUHAN YANG MENJANJIKAN KEABADIAN DENGAN SYARAT TERTENTU. 
KONON DUNIA TIDAK SESEDERHANA YANG TERLIHAT. IA MEMILIKI 2048 DIMENSI SEMENTARA 
MANUSIA TERKURUNG DI EMPAT YANG TERENDAH UNTUK MENEMBUS LAPISAN YANG LEBIH TINGGI 
DIPERLUKAN SEBUAH PENGORBANAN YANG DIPILIH DENGAN LOGIKA OBSESIF SEORANG PEREMPUAN 
YANG SETIAP HARI BERDIRI DI DEPAN RUMAH MENJAJAKAN MINUMAN DINGIN DIANGGAP SEBAGAI 
VARIABEL YANG TAK DIJAGA CUKUP UNTUK MEMBUKA JALAN MENURUT KEYAKINAN ITU RITUALNYA 
DIGAMBARKAN DENGAN MEMOTONG TUBUHNYA SEBANYAK 2048 KALI LALU DIKUBUR DI PUSAT KODE 
COM/(-6.2892995,106.9964141)
```

Koordinat: **-6.2892995, 106.9964141**

---

## Step 6: Analisis Koordinat

Membuka koordinat di Google Maps menemukan lokasi dengan nomor telepon.

<div style={{ textAlign: 'center' }}>
  <img src="https://hackmd.io/_uploads/BJXjwjiBWx.png" />
  <div><i>Mohon tidak menyalahgunakan nomor telepon yang tertera</i></div>
</div>

Menggabungkan domain dengan nomor telepon: **https://pusatkode.com/081317155457**

---

## Step 7: Analisis Video

URL tersebut mendownload file video (.mov/.mp4). Video menampilkan:
- Seseorang menelepon dengan dering 2 kali
- Pintu kosong dengan URL tertera
- Jumpscare di akhir

URL yang tertera: **https://pusatkode.com/B6yadxhk.png**

<div style={{ textAlign: 'center' }}>
  <img src="https://hackmd.io/_uploads/H1XKKojHWe.png" alt="Video Frame" width="250" />
</div>

---

## Step 8: Analisis Steganografi Gambar Pertama

Gambar hitam 1080x1080 dengan anomali pada channel alpha.

<div style={{ textAlign: 'center' }}>
  <img src="https://hackmd.io/_uploads/H1g6vpOUZl.png" alt="Anomali" width="400" />
</div>

Ditemukan **32 pixel** dengan nilai alpha tidak solid. Setelah diperiksa:
- Pola R=G=B pada setiap pixel
- Nilai berada di rentang 32-126 (ASCII printable)

**Hasil konversi ASCII:** `00244689aaabdeehinnoprrssstttwy`

**Analisis:**
- Angka dapat membentuk: 2048 dan 4096
- Huruf dapat membentuk: "password" 
- Sisa huruf: `aabeehinnrsttty`

Menggunakan anagram solver, didapat: **"4096 IS BETTER THAN 2048"**

Password awal (salah): `passwordnya4096isbetterthan2048`

---

## Step 9: Clue Tambahan & Video Kedua

**Clue dari Vinco:**
> Temukan sebuah nomor telepon (JGN DOX) di map, gunakan di jam spesifik yaitu 20:48:00 WIB sesuai dengan tema.

Pada waktu **20:48:00 WIB**, video di https://pusatkode.com/081317155457 berubah menampilkan URL baru:

**https://pusatkode.com/a0K3np1Y.png**

<div style={{ textAlign: 'center' }}>
  <img src="/write-up-assets/image2.png" alt="Gambar Kedua" width="400" />
</div>

---

## Step 10: Analisis Steganografi Gambar Kedua

Gambar identik 1080x1080, namun berbeda pada channel alpha.

<div style={{ textAlign: 'center' }}>
  <img src="/write-up-assets/image3.png" alt="Alpha Channel Comparison" width="400" />
</div>

Setelah compare dengan gambar pertama:
- **66 pixel berbeda** dari gambar sebelumnya
- 32 pixel dari gambar pertama merupakan **subset**
- Ekstrak **34 pixel eksklusif**

<div style={{ textAlign: 'center' }}>
  <img src="/write-up-assets/image4.png" alt="Pixel Analysis" width="400" />
</div>

Alpha channel hanya noise karena semuanya berbeda. Namun saat dicek posisi pixelnya, ternyata 32 pixel pada file sebelumnya merupakan subset (subhimpunan) dari 66 pixel ini.

<div style={{ textAlign: 'center' }}>
  <img src="/write-up-assets/image5.png" alt="Extracted Pixels" width="400" />
</div>

**Hasil konversi ASCII:** `0248aaaaaaaabddeghikklnnoprrsstwy`

---

**Analisis:**
- Eliminasi: "passwordnya", spasi, "2048"
- Sisa: `aaaaaabdeghikklnrt`

Setelah filtering manual dari dictionary bahasa Indonesia:
- Kata kunci: `adalah` dan `angka`
- Sisa huruf: `abeikrt` → `terbaik`

---

## Solusi

**Flag/Password:**

```
2048adalahangkaterbaik
```

---

## Timeline Solve

1. **Analisis APK** → URL Lambda AWS pertama
2. **Binary Array** → Bitmap → URL HTML
3. **Clock Trigger** → URL Lambda AWS kedua  
4. **Morse Code** → Koordinat
5. **Google Maps** → Nomor telepon → Video
6. **Video** → Gambar PNG pertama
7. **Steganografi Alpha Channel** → Anagram pertama (salah)
8. **Time-based Trigger** → Video kedua → Gambar PNG kedua
9. **Compare Steganografi** → Anagram bahasa Indonesia
10. **Final Password**

---

**Tools yang Digunakan:**
- Python (PIL, anagram solver)
- APK Decompiler
- Image analysis tools
- Google Maps
- Anagram solver (https://boulter.com/anagram/)

## Credits
Thanks buat semua yang sudah berpartisipasi, merangkum write-up, dan selamat untuk pemenang